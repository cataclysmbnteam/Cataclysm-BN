# Повреждение игровых файлов и сохранений

Повреждение игровых файлов и сохранений попадает в следующие категории:

1. Вызвано вашей системой
2. Вызвано вашим лаунчером
3. Вызвано игрой
4. Вызвано неправильной процедурой обновления
5. Вызвано смертью персонажа

## Повреждение, вызванное вашей системой

### Общие симптомы

- Бессмысленные сообщения об ошибках при попытке загрузить сохранение (например, "expected comma" (ожидалась запятая) или "expected array" (ожидался массив))
- Проблемные файлы при открытии в приличном текстовом редакторе (Notepad++ для пользователей Windows) частично заполнены нулевыми байтами или другой бессмыслицей
  ![image](https://user-images.githubusercontent.com/60584843/186019683-36a59d3b-31ce-408c-96ee-42390975171c.png)

### Общие причины и способы избежать

1. Недостаточно места на диске (купите диск побольше)
2. Неисправный диск (купите новый диск)
3. Сохранение на USB-флешку / внешний жесткий диск и выдергивание его без "Безопасного извлечения" (не делайте этого)
4. Отключение электричества (купите ИБП для вашего компьютера)
5. Потеря питания из-за сбоя оборудования (вызовите ремонтников ПК)
6. Потеря питания из-за действий пользователя (не выдергивайте вилку питания вашего ПК, не выключайте ноутбук долгим нажатием кнопки питания)
7. Синий экран или аналогичная неустранимая ошибка ОС (опять же, вызовите ремонтников ПК)

### Исправление повреждения

Мы ничего не можем с этим поделать, но вы можете попробовать функциональность резервного копирования файлов вашей ОС (или функциональность резервного копирования игрового лаунчера, если его резервные копии тоже не повредились).

## Повреждение, вызванное вашим лаунчером

### Общие симптомы

1. Все (или некоторые) сохранения внезапно исчезли
2. Все (или некоторые) ваши личные настройки в `[корень игры]/data/` внезапно отменены
3. Все (или некоторые) ваши моды/саундпаки внезапно исчезли
4. Все (или некоторые) настройки сброшены по умолчанию

### Общие причины и способы избежать

1. Лаунчер глючный. Доставайте автора(ов)/сопровождающего(их), чтобы исправили это, или найдите другой лаунчер - может быть, тот, который [старается не трогать пользовательские данные](https://github.com/qrrk/Catapult).
2. Ваши моды/саундпаки/личные настройки находились внутри папки `[корень игры]/data/`. Эта папка предназначена только для базовых вещей игры, поэтому не удивляйтесь, если она будет перезаписана/стерта/повреждена после обновления. Специально чтобы избежать этой ситуации, игра позволяет размещать эти файлы в так называемых "пользовательских" папках - в Windows это будут папки с именами `[корень игры]/mods/` и `[корень игры]/sound/`. Все личные настройки должны идти в отдельный мод, помещенный в ту же папку `[корень игры]/mods/`, а когда это невозможно из-за ограничений системы моддинга - храниться в какой-то форме резервной копии, желательно подальше от `[корень игры]/`, чтобы лаунчер не посчитал это мусором.
3. У лаунчера могут быть свои причуды. Например, одно из недавних обновлений популярного лаунчера имело большое предупреждение, которое некоторые люди решили проигнорировать. Совет здесь аналогичный: доставайте автора(ов)/сопровождающего(их), чтобы решили это (добавили миграцию?) или просто будьте внимательнее.
   ![image](https://user-images.githubusercontent.com/60584843/186022055-0015f2cc-2549-4721-8a0d-8b7047b3d2b1.png)

### Исправление повреждения

Мы тоже мало что можем с этим поделать. Попробуйте попросить исправление у создателей лаунчера или поискать резервные копии в вашей ОС.

## Повреждение, вызванное игрой

### Общие симптомы

1. Всякий раз, когда вы загружаете сохранение, происходит что-то странное, но не ломающее игру (вы умираете, или теряете 10 кг, или ваш спутник-NPC телепортируется вокруг)
2. Всякий раз, когда вы загружаете сохранение, игра кричит на вас о потерянных местоположениях предметов

### Общие причины и способы избежать

Это игровые баги, и их нужно исправлять, а не избегать. Мы не можем исправить то, о чем не знаем, поэтому о багах нужно сообщать - либо на GitHub, создав [Bug Report](https://github.com/cataclysmbn/Cataclysm-BN/issues/new/choose) (вам нужен только рабочий адрес электронной почты, чтобы создать аккаунт на GitHub, это не _так_ сложно), либо присоединившись к [нашему серверу Discord](https://discord.gg/XW7XhXuZ89) и пожаловавшись в канале `#development` - там вы, скорее всего, получите более быстрый ответ. Если вы знаете, как это исправить (или хотите попробовать) - помощь всегда приветствуется.

### Исправление повреждения

Сохранения в этих случаях обычно можно исправить, хотя точный метод варьируется от случая к случаю.

Если игра показывает красно-черные сообщения, в которых говорится что-то о `ACT_XXX lost target item` или `item_location lost target during save/load cycle`, попробуйте сделать резервную копию сохранения, затем открыть файл сохранения вашего персонажа (обычно `[корень игры]/save/[Имя Мира]/#[тарабарщина].sav`) любым приличным текстовым редактором (Notepad++ для Windows подойдет), найти все вхождения последовательностей, начинающихся с `ACT_` (например, `ACT_DROP` или `ACT_WASH`), и заменить их на `ACT_NULL`.

## Повреждение, вызванное неправильной процедурой обновления

### Общие симптомы

1. После ручного обновления игра показывает странные ошибки, о которых никто, кого вы спрашиваете, не знает или не сталкивался, даже если вы не используете никаких модов.
2. Ошибки исчезают после чистой переустановки игры.

### Общие причины и способы избежать

Вы, скорее всего, обновляете игру, скачивая свежую версию и распаковывая её поверх существующей установки. **Это не поддерживается и никогда не поддерживалось.** Как правило, плохая идея обновлять программы таким образом, если только они явно не заявляют, что могут с этим справиться и это разрешено. BN не может с этим справиться. Моды, которые вы скачали и обновили таким же образом, скорее всего, тоже не могут с этим справиться.

### Исправление повреждения

Просто сделайте чистую переустановку или используйте лаунчер.

## Повреждение, вызванное смертью персонажа

### Общие симптомы

Ваш персонаж умирает - это трагедия, и вы хотели бы повернуть время вспять, в старые добрые времена.
И тут вы понимаете, что можете сделать именно это, нажав Alt+F4. Но при следующей загрузке сохранения вы видите свой труп рядом со всеми дублированными предметами, а вашего транспорта нигде не видно.

### Общие причины и способы избежать

Вы пытались обмануть смерть, но потерпели неудачу и в конечном итоге были забыты среди миллиардов, погибших в катаклизме.

### Исправление повреждения

Вам придется жить с напоминанием о ваших ошибках. Попробуйте сделать резервную копию сохранения в следующий раз.
Технически это баг, но это также легкий выход, поэтому никто на самом деле не заботится о его исправлении.
